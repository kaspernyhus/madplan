{% extends 'base.html' %}

{% load static %}

{% block content %}


<div class="recipe-top" style="background-image: url('/media/{{ recipe.photo_thumbnail }}');">
  <span class="recipe-header">
    <a href="{% url 'show_recipe' recipe.id %}" class="header"><h1 class="header">{{ recipe.name }}</h1></a>
    <p class="subheader">{{recipe.description}}</p>
  </span>
</div>

<div class="center-nav">
  <button class="nav-but active" id="but1" onclick="showBlock1()">Ingredienser</button>
  <button class="nav-but" id="but2" onclick="showBlock2()">Fremgangsmåde</button>
</div>


<h5 class="header">Rediger ingrediensliste</h5>

<div id="Block1">
<table class="center">
  <colgroup>
      <col style="width: 50%;">
      <col style="width: 20%;">
      <col style="width: 25%;">
      <col style="width: 5%;">
  </colgroup>
  <tbody>
  <form method="POST">
    {% csrf_token %}
    {% for recipe_ingredient in recipe_ingredients %}
    <tr>
      <td>
        <span>{{ recipe_ingredient.name }}</span>
      </td>
      <td>
        <span>{% if recipe_ingredient.description %} {{ recipe_ingredient.description }} {% endif %}</span>
      </td>
      <td>
        <span>{% if recipe_ingredient.recipe_ingredient_description %} {{ recipe_ingredient.recipe_ingredient_description }} {% endif %}</span>
      </td>
      <td>
        <input type="number" class="sml-number-input" id="qty" name="qty" value="{{recipe_ingredient.amount}}" min="0" max="1000" step="0.1"> {{ recipe_ingredient.unit }}
        <input type="hidden" id="ingredient_id" name="ingredient_id" value="{{ recipe_ingredient.ingredients_id }}">
      </td>
      <td>
        <button type="submit" class="delete_cross" id="delete_ingredient" name="delete_ingredient" value="{{recipe_ingredient.id}}">x</button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<div class="center">
  <button type="submit" name="edit_quantities">Gem</button>
</div>
</form>


<div class="center">
<h6>Tilføj en ingrediens</h6>
<form method="POST" class="add-form">
  {% csrf_token %}
  <input type="text" list="ingredient_list" name="ingredient" placeholder="Vælg ingrediens..">
  <datalist id="ingredient_list">
    {% for ingredient in all_ingredients %}
      <option value="{{ingredient.id}}: {{ ingredient.name|title }}{% if ingredient.description %}, {{ingredient.description}} {% endif %}"></option>
    {% endfor  %}
  </datalist>
  <input type="text" name="description" value="" placeholder="beskrivelse..">
  <input type="number" name="qty" value="" placeholder="mængde" step="0.1" required>
  <select list="qty_units" name="qty_unit" value="" placeholder="enhed.." required>
    {% for unit in units %}
      <option value="{{ unit.unit_name }}">{{ unit.unit_name }}</option>
    {% endfor %}
  </select>
  <div class="center">
  <button type="submit" name="add_ingredient" value="">tilføj</button>
</div>
</form>
</div>


<a href="{% url 'new_ingredient' %}?next={{ request.path }}" class="center">Opret ny ingrediens</a>
</div>


<br>

<h5 class="header">Rediger fremgangsmåde</h5>

<div id="Block2">
  <div class="center">
    <form method="POST" id="instructions">
      {% csrf_token %}
      {% for instruction in instructions %}
        <textarea class="center instr-text" name="textarea_instructions" form="instructions">{{instruction.description}}</textarea>
      {% endfor %}
        <textarea class="center instr-text" name="new_instruction" form="instructions"></textarea>
      <div class="center">
      <button type="submit" name="edit_instructions">Gem</button>
    </div>
    </form>
  </div>
</div>


<h5 class="header">Rediger tags</h5>

<div class="center">
  <form method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <div class="center">
    <button type="submit" name="edit_tags">Opdater</button>
  </div>
  </form>
</div>

  
{% endblock %}